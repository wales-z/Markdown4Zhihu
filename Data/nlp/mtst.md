# Multi-Task Sequence Tagging for Emotion-Cause Pair Extraction Via Tag Distribution Refinement

通过标签分布细化用于情感原因对提取的多任务序列标记

## 摘要

情感-原因对 (emotion-cause pair) 提取这一任务处理的是从情感文本中找到所有情感和相应的原因。 现有的联合方法将其解决为多任务学习，它引入了两个辅助任务（即情感提取和原因提取）以利用任务相关性来实现它们的相互利益。 然而，这些方法专注于通过以隐式方式共享参数来捕获这种相关性，不仅存在**无法明确对其信息交互进行建模**的局限性，而且还存在**可解释性低**的问题。 针对这些问题，我们提出了一个多任务序列标记框架，它可以通过将它们的距离编码成一种新的标记方案来同时提取具有相关原因的情绪。 此外，两个辅助任务的输出可以直接用作 inductive 偏置，细化标签分布，从而有利于情感-原因对的提取，使它们之间的信息交换更加明确和可解释。 结果表明，我们的模型实现了最佳性能，在 F1 分数上比许多竞争基准至少高出 1.03% (p < 0.01)。 综合分析进一步证实了我们模型的优越性和稳健性。

## 1 引言

情绪在人类交流和决策制定中发挥着重要作用 [1]。 以前关于情绪分析的研究集中在情绪分类 [2]-[6] 上，其目的是从文本中推断极性和/或检索意见。 然而，有时，我们可能更关心刺激因素 (stimuli)，或者人们持有或改变情绪的原因，而不是简单的类别标签。 因此，旨在推断情绪表达背后原因的情绪原因提取 [7] 引起了越来越多的兴趣。 传统的情感原因提取方法依赖于基于语言的规则 [8]-[11] 或特征工程 [12]-[16]，这些方法既费时又费力。 最近的研究使用具有精心设计的注意力机制的神经模型解决了这个任务[17]-[19]。 Gui 等人[17] 提出了一种基于卷积的注意力机制，将相关上下文存储在不同的记忆槽中，以更好地捕获词级序列特征。 基于 Transformer 的模型 [18] 取得了优于 multi-layer 和 multi-head 的自注意力架构的性能。 此外，情感原因提取可以受益于使用外部情感资源和参数约束的先验知识 [19]

尽管支持情绪原因提取的理论、方法和实验取得了很大进展，但现有工作要求在提取原因之前必须对情绪进行注释，这忽略了情绪-原因结构的互利性，限制了在现实世界的场景中的应用范围。针对这些问题，Xia 和 Ding [20] 提出了一项名为情绪-原因对提取（ECPE）的新任务，旨在从未注释的文本中提取所有潜在的情绪和相应的原因组成的对。 考虑表 I 中显示的情感文本。这里有两个情感-原因对：（he enjoys it, with more... customers）和（but this... worry, his parents... resignation）。 我们可以观察到，即使在同一个情感文本中，也可能存在多个由不同情感词（例如，enjoy和worry）表达的相反的情感极性，并且与不同的原因相关。 这表明我们需要对文本内容和结构有一个全面的了解，才能进行因果推理并从消极的情感-原因对中识别出情感-原因对。

<img src="https://gitee.com/Wales-Z/image_bed/raw/master/img/image-20210916224031323.png" alt="image-20210916224031323" style="zoom: 67%;" />

一般来说，由于情绪固有的模糊性和微妙性，情绪-原因对提取是一项更具挑战性的任务。

现有的两步解决方案已经显示出它在这个任务上的有效性 [20]，它涉及两个过程：1）从文本中提取情感/原因；  2）将它们配对并从所有可能的对中过滤掉负对。 然而，这种流水线框架并不理想，导致相关任务的互利性无法得到充分利用的缺点。 此外，可能会发生错误传播。 如图 1(a) 所示，鉴于情感/原因提取和 ECPE 之间的强相关性，已经研究了使用一个共享的编码器的多任务学习来模拟它们的互利 [21]-[23]。 虽然实现了有希望的性能，但我们认为简单地依靠参数共享来总结或记忆这种多方面的相关性是有风险的，例如，EE/CE 对 ECPE 的预测结果的影响以及情绪和原因之间的相对距离信息。 此外，情感和原因信息如何指导情感-原因对提取的可解释性仍然很弱，因为它们之间的信息交换是隐式的。

<img src="https://gitee.com/Wales-Z/image_bed/raw/master/img/image-20210916224550626.png" alt="image-20210916224550626" style="zoom: 67%;" />

在本文中，我们提出了一种具有标签分布细化的多任务序列标记框架来解决上述问题。首先，我们将情感-原因对提取视为一个序列标签问题。 挑战在于还要将因果推理纳入标签方案，这意味着传统的 BIO 标签不适合这项任务。 因此，我们设计了一个带有多个标签的标记方案，其中可以通过对链接组件之间的距离进行编码来包含情绪和相关原因的信息。 通过这种方式，情感-因果结构被整合到一个统一的框架中，包括表征学习、成分提取和因果推理。

其次，如图 1(b) 所示，所提出的框架还在两个辅助任务（即 EE 和 CE）的帮助下解决了 ECPE，从而能够利用这些任务的相关性。 在多任务框架之上，通过直接利用两个辅助任务的输出和两个子句之间的相对距离产生的偏移向量来细化每个子句的预测标签分布。 此操作在输出上明确执行，而不是仅通过学习公共特征表示来共享信息。因此，我们的方法不仅允许共享特征，而且还明确地对不同任务的相关性进行建模并减少预测方差以提高彼此的性能，从而最大化互惠互利并使交互过程更具可解释性

我们在基准数据集上进行实验 [15]。 结果表明，我们的方法在情感-原因对提取方面取得了最佳性能，优于许多竞争基线（在 F1 测量中至少为 +1.03%）。 广泛的分析进一步证实了我们方法的优越性和稳健性。 源代码可在 https://github.com/HLT-HITSZ/MTST-ECPE 获得。



## 3 方法

#### E. 标签分布细化

细化标签分布的目标是明确利用不同任务之间的相关性，并利用信息交互进行改进。 具体来说，每个子句的标签分布由一个偏移向量 v 细化，它是直接使用两个辅助任务（即情感提取和原因提取）的输出计算的。 通过这种方式，我们可以很容易地展示两个辅助任务如何直观地指导情绪-原因对提取。

形式上，对于每个 xi ∈ X，我们首先考虑一个子句窗口，它由紧邻 xi 左侧和右侧的 xi 和 r 周围子句组成。 这为我们提供了一个大小为 2r + 1 的子句窗口，称为“子句块”并表示为 K。我们在这样的子句块上定义了标签分布细化策略，我们认为与其他较远的子句相比，它传达了最相关的信息。

