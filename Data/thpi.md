# Transfer Hashing with Privileged Information

使用特权信息的迁移哈希

# 摘要

​	  大多数现有的学习哈希 (learning to hash)方法都假设在感兴趣的域（即目标域）上有足够的数据（无论有无标签）用于训练。 但是，在某些实际应用中无法满足此假设。为了解决哈希中的这个数据稀疏问题，受迁移学习的启发，我们提出了一个新的框架，名为使用特权信息的迁移哈希（THPI）。具体来说，我们将标准学习扩展到哈希方法，迭代量化（Iterative Quantization, ITQ），以迁移学习的方式，叫做 ITQ+。在 ITQ+ 中，从辅助数据中学习了一个新的松弛函数来近似 ITQ 中的量化误差。 我们开发了一种交替优化方法来解决 ITQ+ 的最终优化问题。我们通过利用辅助数据中的几何结构来学习目标域中更精确的二进制代码，进一步将 ITQ+ 扩展到 LapITQ+。通过与几个最先进的baselines进行比较，在几个基准数据集的大量实验验证了我们提出的方法的有效性。

## 介绍

​	  哈希方法已被应用许多应用领域的高效相似性搜索，尤其是信息检索 [Wang et al., 2016]。哈希的目标是，在每个数据实例的低维空间中，设计或学习一个紧凑的二进制代码，每一位取值为 -1/1 或 0/1，以便映射原始空间中的相似实例到类似的二进制代码。结果，可以以较低成本存储数据实例，并且可以使用二进制运算（XOR）通过汉明距离有效地计算实例之间的相似性。

​	  大多数现有的学习哈希方法需要大量数据实例来学习一组哈希函数来构造二进制代码 [Wang et al., 2016]。然而，在一些实际应用中，对于感兴趣的域，即目标域，数据实例可能不够学习精确的哈希模型。例如，淘宝网为小企业和个体企业家提供开设网上商店的平台。假设一个个体企业家想要为他/她的在线商店中销售的产品的所有图像构建一个哈希系统。不幸的是，图像的数量不足以构建精确的哈希系统。一个简单的解决方案是从其他电子商务网站（例如 Amazon.com 或 eBay.com）下载相同或相关产品的图像，以帮助学习哈希系统。但是，在淘宝网的很多个体网店中，展示商品的图片通常是业余的，是个体创业者自己拍摄的，而亚马逊展示的商品图片则是专业的。这两种不同类型的图像的简单聚合可能无助于为目标图像学习精确哈希系统。受迁移学习的启发 [Pan and Yang, 2010]，不是直接使用从亚马逊网站或其他电子商务网站下载的图像，而是从**辅助图像**中提取知识，然后将知识迁移，以帮助为目标图像学习更精确的哈希系统。

​	  具体来说，我们提出了一个名为“使用特权信息的迁移哈希”（THPI）的新框架，它是迁移学习和新的学习范式的结合，即使用特权信息的学习（LUPI），由 [Vapnik and Vashist, 2009]提出，其中特权信息被假设为可用于训练短语 (phrase)中的每个训练实例，而对测试短语不可用。我们的目标是通过对来自源域的特权信息（例如从 Amazon.com下载的产品图像）进行编码，为特定的目标域（例如，单个在线商店中的产品图像）构建精确的哈希码，变成学习哈希模型。在这个例子中，目标图像可以被认为是训练实例，而与目标图像相同或相似产品的辅助图像可以被认为是它们在训练短语中的特权信息。如 [Vapnik and Izmailov, 2015] 所示，在特权信息的帮助下，训练所需的训练数据量显着减少。因此，我们期望通过特权信息，能够为数据实例不足的目标域学习精确的哈希函数。

​	  请注意，所提出的 THPI 框架与跨模态哈希不同，后者假设不同模态的训练实例充足，并且足以分别学习可靠的哈希码 [Kumar 和 Udupa，2011]。在大多数跨模态哈希方法中，需要跨不同模态的完整对应作为输入 [Kumar and Udupa, 2011; Wu等人，2015]。此外，跨模态哈希的目标是跨模态检索相关数据。在 THPI 中，目标是在目标域中学习一组训练实例不足的良好哈希函数，并在目标域中检索相关信息。

​	  我们工作的新颖之处总结如下： 

- 提出了一个名为“具有特权信息的传输哈希”（THPI）的新框架，通过从源域迁移知识来减轻目标域中的数据稀疏性。
- 提出了一种名为 ITQ+ 的新算法，其中引入了一种用于合并特权信息的新松弛函数，以规范目标域哈希码的学习。
- 我们进一步将 ITQ+ 扩展到 LapITQ+，其中从源域中提取的底层图结构被编码为先验，以便为目标域学习更精确的哈希码。

## 相关工作

其余略

### 使用特权信息的学习

​	  最近，Vapnik 和 Vashist [2009] 引入了一种新的学习范式，即使用特权信息的学习（LUPI）。在 LUPI 中，假设辅助特权特征在训练短语中可用，但在测试短语中不可用。提出了一种新模型 SVM+，利用特权特征构建传统支持向量机 (SVM) 中的校正函数 (correcting function)来控制损失，从而使学习到的分类器具有更强的泛化能力。具体来说，给定一组训练数据 ${x_i , \tilde x_i}^l_{i=1}$ ，其中 $\hat x$ 是原始特征 $x$ 对应的特权特征，SVM+旨在从原始特征向量学习目标分类器 $f(x) = w^Tx$ 和从特权特征向量学习一个松弛近似函数 $\epsilon(\tilde x) = \tilde w^T \tilde x $，同时。 松弛近似函数的目标是通过合并特权特征来控制目标分类器的损失。SVM+的目标函数写成如下：



​	  受到 SVM+ 公式和 LUPI 最新进展的启发 [Niu et al., 2016; Xu等，2015；  Sharmanska et al., 2013]，在这项工作中，我们的目标是通过结合特权信息来构建一个用于哈希的松弛函数，以在数据稀疏的目标域中学习更精确的哈希模型

## 使用特权信息的迭代量化 (ITQ+)

​	  假设我们有 n 个数据点 {xT1 , xT2 , .  .  .  , xTn } 与 xTi ∈R dT 。 用 XT = [xT1 , .  .  .  , xTn ] > ∈R n×dT 数据矩阵。 不失一般性，我们假设所有 n 个点都以零为中心，即 Pn i=1 xTi = 0。
学习哈希的目标是学习一个二进制码矩阵 BT ∈ R n×c，其元素在 {−1, 1} 中，其中 c 是每个哈希代码的长度。 对于每个位 k ∈ {1, ..., c}，学习二元函数 hk(xT ) = sgn(r > k xT )，其中 rk ∈ R dT 是第 k 位的超平面。 用R ∈ R dT ×c 表示所有c 位的投影矩阵，可以通过设置BT = sgn(XT R) 得到二进制码矩阵BT。

​	  当 n 较小时，即可用的目标训练数据有限，现有方法学习的哈希码可能表现不佳。 如何从稀疏数据中学习精确的哈希模型是大多数现有的哈希学习算法的关键问题。 受到 LUPI 令人兴奋的结果的启发，这证明使用特权信息可以显着减少训练数据量，以训练精确的预测模型 [Lapin et al., 2014;  Vapnik 和 Vashist，2009 年；  Vapnik 和 Izmailov，2015 年]，我们提出了一个新的哈希学习框架，即具有私有信息的传输哈希（THPI）。 在 THPI 中，目标域上的数据稀疏问题通过使用来自辅助域（称为源域）的特权信息来缓解。 除了目标特征向量 xT ，在 THPI 中，我们假设来自源域的相应特权信息 xS ∈ R dS 也可用于训练，这意味着有 n 个相应的数据对 {(xS1 , xT1 ),(xS2  , xT2 ), .  .  .  ,(xSn , xTn )} 用于训练。 此外，我们用 XSC = [xS1 , .  .  .  , xSn ] > ∈ R n×dS 源域上 n 个对应实例的矩阵，且 XSU = [xSn+1 , xSn+2 , .  .  .  , xSn+nS ] > ∈ R nS×dS 附加 nS 源域实例的矩阵。 请注意，特权信息仅可用于训练，不能用于测试

### ITQ

​	  ITQ 算法 [Gong 和 Lazebnik，2011] 旨在使用迭代量化方法构建哈希函数，通过最小化量化误差来学习旋转矩阵。 具体来说，正交投影矩阵 RT ∈ R dT ×c 通过优化以下量化损失与编码矩阵 BT ∈ {−1, 1} n×c 学习

